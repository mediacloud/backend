#
# Webapp (HTTP server)
#

FROM mc2021/nginx-base:latest

# Copy configuration
COPY nginx/include/webapp-httpd.conf /etc/nginx/include/

# Set up volume for daily RSS dumps generated by
# "cron-generate-daily-rss-dumps" app
RUN \
    mkdir -p /mediacloud_webapp_static/static/rss_dumps/ && \
    #
    # "www-data" user / group is shared with "cron-generate-daily-rss-dumps"
    # which will be reading files generated by this app (Nginx itself doesn't
    # run as "www-data" but just need to use a common user here)
    chown -R www-data:www-data /mediacloud_webapp_static/static/rss_dumps/ && \
    #
    true

VOLUME /mediacloud_webapp_static/static/rss_dumps/

# Web server's port
EXPOSE 80

# Run Nginx
CMD ["nginx"]
